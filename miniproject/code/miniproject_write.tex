\documentclass[11pt]{article}
\title {Quantifying the overlap of sharks, enforcement and illegal fishing inside one of the worldÂ’s largest marine protected areas}
\author{Emma Deeks}
\date{10 Dec 2019}
\usepackage[margin=2cm]{geometry}
\usepackage{graphicx}
\usepackage[]{lineno}
\usepackage[backend=biber,style=authoryear,bibencoding=utf8]{biblatex}
\usepackage{setspace}
\setlength{\parindent}{0em}

% bibliography secion %

\addbibresource{miniproject.bib}

\begin{document}
	
	\begin{titlepage}
		
		
		\centering % this centers everything on the page
		
		%\vspace  % Whitespace at the top of the page 
		
		
		
		% --------------------------
		%% TITLE
		
		\vspace*{5\baselineskip}
		
		\rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt} % Thick horizontal rule
		\rule{\textwidth}{0.4pt} % Thin horizontal rule
		
		\vspace{0.75\baselineskip} % Whitespace above the title
		
		{\LARGE How well do different mathematical models, based upon foraging theory (mechanistic) principles vs. phenomenological ones, fit to functional responses data across species? \\} 
		
		\vspace{0.75\baselineskip} % Whitespace below the title
		
		\rule{\textwidth}{0.4pt}\vspace*{-\baselineskip}\vspace{3.2pt} 
		\rule{\textwidth}{1.6pt} 
		
		\vspace{2\baselineskip} 
		
		% ---------------------------------
%% SUPERVISORS & CONTACT EMAIL

Student: \\
Emma Alice Deeks \\ 
	
		\vspace{1.5 \baselineskip} % Whitespace between text
		
		Contact: \\
		ead19@imperial.ac.uk\\
		
			\vspace{1.5 \baselineskip} % Whitespace between text
			
		Words: 2966
		

	\end{titlepage}
	
	\linenumbers
	\doublespacing
		\section*{Abstract}
	\noindent
	Functional responses are used to understand the interactions between predators and prey. These interactions can be used to predict how predator-prey relationships are affected by changing densities and on a larger scale, how ecosystems respond to change. Using 214 functional response curves from different species this study aimed to address the question on which mathematical model best fits functional response curves. This study also aimed to analyse whether the habitat as well as the dimension the predator encounters the prey in would affect which model would fit the functional response curve best. This study found phenomenological model best fit functional response curves according to Akaike Information Criterion (AIC) values but cautioned the use of these models due to the biases induced by principles such as parsimony. As well as this it also evaluated the impact of habitat and dimensionality on model fits. 
	
	\section*{Introduction}
	\noindent

	
Functional responses describe the way in which a predator responds to changing densities of prey (\cite{Holling1959}). The rate at which a predator kills its prey at different densities ultimately determines the efficiency of a predator in regulating population densities of prey. (\cite{Murdoch1975}). \cite{Holling1959} described three types of functional responses curves, the first, an increasing linear relationship indicating a constant rate of predation. The second, a decelerating curve which indicates saturation at a certain level, e.g. saturation of predator eating prey. The third, a sigmoidal relationship which indicates an increased rate of prey killing, or, positive density dependant prey mortality (\cite{Pervez2005}). It has been observed that often, the type II functional response is favoured in predator prey relationships, that is a curve which starts at low prey densities and as the prey density increases so does the predation rate linearly until it saturates at an upper limit (\cite{Jeschke2002}). Functional response models are used, often above linear models, as they incorporate two parameters which are handling time (time required to attack, consume and digest prey) and attack/search efficiency of a predator to a prey (\cite{Fathipour2016}). Functional response models can be applied in ecology when predicting future population densities of predators and prey within the functional response relationship as well as what happens to each member of the relationship when densities of one changes (\cite{Jeschke2002})

Functional responses can be modelled in a phenomenological way, such as the quadratic model, which cannot explain the underlying mechanism of the curve they produce, the parameters cannot be mechanistically explained, but still produce the traditional type II response curve. The second model type is the mechanistic model, such as the Holling Type II model,  (\cite{Holling1959}) where the parameters involved can all be mechanistically explained and are developed to describe a biological mechanism (\cite{Jeschke2002}).

Whilst these models are widely used to fit functional responses between species, many other factors can potentially effect the functional responses between species in space and time. The shape of the functional response curve is dependent on several characteristics such as the encounter rare, capture efficiency and the handling time of the predator (\cite{Holling1965}), these various characteristics are often species dependant as species vary in a number of attributes such as size and space (\cite{Elliott2003}). To account for these varying characteristics studies such as \cite{Aljetlawi2004}  have included body size to produce a size dependant functional response. Other studies such as \cite{Pawar2012} have highlighted the importance of considering the dimensions in which consumers encounter resources, for instance, 2D involve terrestrial habitats whereas 3D include aerial and pelagic encounters. Predators in 3D were found to encounter prey significantly more than 2D (\cite{Pawar2012}). Studies such as these highlights the importance of not only choosing the best model to accurately describe functional response, but to consider the importance of species on a more individual basis, for instance, the habitat they occupy and the dimension in which predators encounter resources. 

This study looks at two mechanistic and two phenomenological models and fits them to a functional response dataset from \cite{Pawar2012} study in order to find whether mechanistic or phenomenological best describes functional response data. This study also looks at the dimensions and habitats the species included in the functional response curves are in and aims to test whether the model type varies based on this. The equation of the mechanistic Holling Type II model: 

$$c=\frac{ax\textsubscript{R}}{1+ha\textsubscript{R}}$$

includes parameters for search rate (a) and handling time (h). This model as well as the phenomenological quadratic model are expected to fit Type II functional responses best. Holling's type III functional responses best fit cubic polynomial phenomenological model c=R\textsuperscript{3} or, Generalised functional response model which has the additional spatial parameter of q:

$$c=\frac{ax\textsubscript{R}\textsuperscript{q+1}}{1 + hax\textsubscript{R}\textsuperscript{q+1}}$$

The key questions of this report are:
	\begin{itemize}
	\item How well do different mechanistic and phenomenological mathematical models fit functional response data
	\item How does habitat effect these model fits? 
	\item How does the dimension the predator encounters the resource in effect model fits? 
	\end{itemize}
\newpage

	\section*{Methodology}
\noindent

Using \cite{Pawar2012} functional response dataset, four models were fitted to 214 functional response curves. The models included the polynomial cubic, phenomenological quadratic, Holling Type II and Generalised functional response models (Fig.1). The consumption rate was plotted against the resource density and the resulting curve was fitted. Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) values were used to determine the best fit model as the lowest value was taken.
The starting values for the Holling Type II and the Generalised functional response model were calculated and optimised for each individual curve. When optimising the starting value for handling time, both the mean and median value were calculated and whichever gave the lowest AIC value was used as the optimised starting value. The slope of the curve from the data points below the h value gave the search rate, (a). The General Functional Response model had an additional spatial parameter (q) which was kept at 0.78 as used by \cite{Pawar2012}. To incorporate an ecological component to the study, the data was subset by habitat and consumer dimensionality to study questions 2 and 3 respectively. \newline

\begin{figure}[h!]
	\centering 
	\includegraphics{../results/Example_modelplot.pdf}
	\caption{Illustration of the four models used to fit 214 functional response curves. In Figure key, Generalised relates to the Generalised functional response, Holling II related to the Holling Type II model, Quadratic relates to the phenomenological quadratic model and the cubic relates to the polynomial cubic model.}
	\label{Four models plotted}
\end{figure}



Computational tools: \newline



The first script in the workflow is a python script that;
	\begin{itemize}
	\item Imports data and subsets based on relevant columns for study, removes any missing values and saves the resulting dataframe to a .csv file 
	\end{itemize}

The second script in the workflow is an R script that;
\begin{itemize}
	\item Imports the modified csv file and nests the data using the 'dplyr' package 
	\item It then runs a function for obtaining initial start values on the nested data and outputs a dataframe of start values called 'datatouse'
	\item It defines the functions of the Holling Type II functional response as 'powMod' and the generalised functional response model as 'GenMod'
	\item This script then optimises starting values to input into a for loop to calculate the best model fit for each ID 
	\item The outputs of this loop are two tables, 'optimisedtable.csv', which has the best fit model for each of the functional response curves as well as the habitat and dimension the species is in. 'MergedOptTable.csv' has every model and their associated AIC values for statistics in the plotting script 
	\item Finally, this script plots all four models on a sample functional response model as an illustration of model fits. (Fig. 1)
\end{itemize}

The third script in the workflow is a python script that;
\begin{itemize}
	\item Imports 'MergedOptTable.csv' and 'optimisedtable.csv' for statistical analysis and plotting of data for results 
\end{itemize}


	\section*{Results}
\noindent

Out of the 214 functional response curves, 134 of the functional response curves had the lowest AIC values of phenomenological model fits, a 20\% increase compared to mechanistic. The difference in model fits between mechanistic and phenomenological were significant ($\chi$\textsubscript{2}(DF = 2, N = 214) = 13.6, p $<$0.01).  Results indicate that phenomenological models best fit the functional response curves, that being the quadratic and cubic models. (Fig.2) Overall, the cubic model fit the most curves with 71 out of 214, the Holling Type II fit the second most with 66 curves fit and the Generalised functional response model fit the least with only 17 curves fit. The phenomenological model fit 60 curves. \newline

\begin{figure}[h!]
	
	\includegraphics[]{../results/mecphe.pdf}
	\caption{Comparison of the number of times that the phenomenological and mechanistic models fit the 214 functional response curves}
	\label{Model Type comparison}
	
\end{figure}

To infer whether habitat and model had a significant effect on the minimum AIC value a repeated measures ANOVA was conducted with a within subject factor of model and a between subject factor of habitat. A Greenhouse Geisser correction was used because the Mauchley's test showed significant sphericity. A probability criteria of p<0.01 was used and the dependant variable was the minimum AIC value. There was a significant main effect of model (F\textsubscript{3, 20.437}, p $<$0.01) and a significant main effect of habitat (F\textsubscript{2, 10.560}, P $<$0.01) on the minimum AIC values (Fig.3). The interaction between the model used and habitat on the resulting minimum AIC value was not significant (F\textsubscript{6, 2.249}, p =0.022).  (Fig. 3). \newline A Tukey Post-Hoc analysis revealed all three habitats to be significantly different from one another. 

\begin{figure}[h!]
	\centering 
	\includegraphics{../results/HabitatBoxplot.pdf}
	\caption{Comparison of best model fits, based on minimum AIC for each model, of different predator-prey functional response curves between different habitats. Quafit = Phenomenological quadratic, Powfit = Holling Type II functional response model, Cubfit = Polynomial cubic model and Genfit = Generalised functional response model respectively. For Generalised functional response curve, the spatial parameter q was kept at 0.78 for all functional response curves }
	\label{Habitat Boxplot of model types}
\end{figure}

A similar analysis was conducted to determine whether there were significant differences between the dimensions in which the predator searches for prey in determining the minimum AIC value and thus, best model fit for each curve. A repeated measures ANOVA was conducted with a within subject factor of model and a between subject factor of consumer dimension. There was a significant main effect of model (F\textsubscript{3, 19.912}, p $<$0.01) and a significant main effect of the dimension the consumer encountered the resource in (F\textsubscript{2, 17.597}, p $<$0.01) on the minimum AIC values (Fig.4). The interaction between the model used and the dimension of the consumer search space on the resulting minimum AIC value was not significant (F\textsubscript{6, 0.530}, p =0.078).  (Fig. 4). \newline A Tukey Post-Hoc analysis revealed all three dimensions, 2D, 3D and sessile were significantly different from one another. 


\begin{figure}[h!]
	\centering 
	\includegraphics{../results/Res_Dim_Boxplot.pdf}
	\caption{Comparison of best model fits, based on minimum AIC for each model, of different predator-prey functional response curves between predator dimensions. Quafit = Phenomenological quadratic, Powfit = Holling Type II functional response model, Cubfit = Polynomial cubic model and Genfit = Generalised functional response model respectively. For Generalised functional response curve, the spatial parameter q was kept at 0.78 for all functional response curves}
	\label{Resource Dimensionality Boxplot of model types}
\end{figure}
\newpage


	\section*{Discussion}
\noindent

Overall, the phenomenological models (quadratic and cubic models), fit 20\% more functional response curves than mechanistic, (Holling Type II and the Generalised Functional response model). However, concluding that phenomenological models are the 'best fit' models for functional response curves is arguably a very general and, inaccurate, conclusion. \cite{Bolker2008} stated that 'mechanistic models are more powerful since they tell you about the underlying processes driving patterns, they are more likely to work correctly when extrapolating beyond the observed conditions'. Mechanistic models are often used above phenomenological models due to their ability to model based on biological processes. The parameters in mechanistic models have been created in an attempt to describe a biological process, such as handling time or search rate used in the Holling Type II model. Phenomenological models are used to fit data, there is no biological relevance behind this fitting of data (\cite{Hilborn1997}). Models that have biological interpretation potentially have more value due to their biological basis (\cite{Johnson2004})  \newline
Whilst this may be a valid explanation on why phenomenological models should not be immediately concluded as the model type that best fit functional response datasets, it does not offer an explanation as to why these models fit best despite not having the biological parameters used by mechanistic models. A likely reason is because the phenomenological models used are simple, which often means they have less bias in model selection. Principles such as parsimony, which is the ratio of degrees of freedom between the alternative and null hypothesis (\cite{Marsh1998}) favour the more 'simplistic' model, a model with fewer parameters and thus, more degrees of freedom (\cite{Mulaik1998}). As a result of this, principles such as parsimony often penalise more complex models that have parameters (\cite{Raykov1999}). If the Holling Type II model and the phenomenological quadratic model had a similar fit to each other, which is highly likely as both models favour Type II functional response curves, the parsimony principle would likely favour the phenomenological quadratic model. This may explain why these more simplistic models were favoured over the mechanistic models and also explain why the generalised functional response model had the lowest best fits. The Generalised functional response model had the additional shape parameter q as well as handling time and search rate parameters. That being said, both phenomenological and mechanistic models are attempting to model functional response curves, despite the debate on model fits both methods are useful in predicting how prey and predator populations are going to respond to density fluctuations and thus help inform management priorities. 

During the analysis, AIC and BIC values were calculated in order to best fit the models, upon inspection AIC and BIC outputs did not differ from one another in terms of reporting overall best fit models for each functional response curve so only AIC values were into the analysis. Future studies should consider appropriate measures of model fit. A study conducted by \cite{Aho2014} found that BIC had a higher probability of selecting a true model compared to AIC upon higher sample sizes. Understanding the different data types that AIC and BIC tools work best on ultimately aids more precise model selection. AIC tools favour data that has a open ended or exploratory approach, such as this study, in which there was no model predicted to do the 'best' in these fits and the data used was derived from real predator prey interactions. BICs are often favoured for finding the correct model whereas AIC are favoured for accurately predicting which model would best suit (\cite{Aho2014}). 

The results of this study found differences between habitats in terms of the best fit model and also found significant variation in the model frequencies. However, there was no significant interaction between habitat and model type on the resulting minimum AIC value. The model that had the highest frequency of appropriate fits was the cubic model, with 71 fits. This poses an interesting question ecologically as the cubic model is most often associated with being the phenomenological Type III functional response model. If this finding was correct and potential bias on model selection was not considered this would mean approximately just over a quarter of the curves showed Type III functional responses. Type III functional responses are favoured over Type II due to their potential in stabilising fluctuating populations of prey and predator populations through density dependant prey mortality (\cite{Sarnelle2008}). However, Type III functional responses are notoriously difficult to detect in nature. A study on Daphnia by (\cite{Sarnelle2008}) found that, despite previous experiments stating Daphnia to not have a Type III functional response, it did under low prey densities. This poses the question of whether it is appropriate to have a model that 'best fits' an empirical dataset when variability in nature is so high, out of the 214 different predator prey interactions there was considerable variability in taxa, habitat, body mass and dimension of predator and prey. It is also not known what prey densities were like for each interaction. This may effect what functional response the interaction best fits. \cite{Dunn2020} found functional response curves to vary significantly within a single ecosystem, they found communities regularly contain multiple predators from diverse taxa and feeding strategy varies hugely from taxa to taxa. For instance, within a small ecosystem generalist crustaceans had nearly double the amount of type III functional responses compared to predatory fishes. Lipicius and Hines (1986) reported double mortality rate for clams in mud vs sand habitats within the same ecosystem. Therefore, when asking how does habitat effect these model fits, this study showed evidence for a significant effect of habitat on model fits but the scope was too broad- future studies should take into consideration other factors affecting this such as the taxa of the species. Too many variables were involved to accurately say whether habitat affects model fits. Additionally, a potential reason for the high frequency of cubic model fit is due to a heightened representation of a specific taxa in the data, sub setting data by taxa or focusing on a single taxa would be a more appropriate way of understanding the effects of habitat on functional responses and recommended models. \cite{Dunn2020} also made the relevant point that it is very hard to distinguish between type II and type III responses due to varying prey densities and stated it was even more hard when multiple predators or prey types are included within experiments. 

A further aspect this study did not take into consideration was body size. Body size can influence functional response curves, e.g. larger fish predators are more effective foragers than smaller consumer species which affects attack rate and handling time (\cite{Dunn2020}). (\cite{Kalinkat2013}) argued that calculating individual functional responses for predator and prey were insufficient in informing population dynamics on a broader scale and proposed allometric scaling models be integrated into functional response types as they include the body mass of the species. This study showed body mass to be important for predator prey interactions through a shift from type II to type III functional responses with increasing predator body mass and decreasing prey mass. Future studies looking to understand predator prey systems on a larger scale could consider using generalised allometric functional response models as opposed to simpler phenomenological models. These allometric models also take into consideration mechanisms that can lead to type III functional responses such as prey refuge and optimal foraging processes (\cite{Murdoch1975}). These rather simplistic mechanistic and phenomenological models treat the Type II and III models as rigid feeding interactions when they are often a consequence of body size and prey densities (Rall 2011).

The final question this study explored was related to the dimension the consumer was encountering the resource in, there was no significant interaction between the dimension the consumer encounters the prey in and the model on the resulting minimum AIC, however there was significant differences between different dimensions (2D, 3D and sessile) and models. This finding was similar to when habitat was explored, and these significant main effects could be due to a range of influences that were previously not taken into consideration. However, it is reasonable to conclude that the dimensionality has a significant effect on the best fiting model and these influences should be different for 2 and 3 dimensions. (\cite{Pawar2012}) found dimensionality is critical for consumer resource dynamics and proposed a mechanistic model that considers the dimensionality as well as the foraging strategy. Future studies would likely benefit from considering this mechanistic model in their analysis of mathematical models on functional response curves especially when comparing a variety of different dimensions and body sizes. 

To conclude, the aims of this study were to understand whether phenomenological models or mechanistic models best fit an empirical dataset, it was found that overall most curves fit the phenomenological data. However, considerable potential bias may have been introduced through principles such as parsimony which would have favoured the phenomenological models due to them being simpler and penalised mechanistic models for having additional parameters. This might explain why the Generalised functional response model had the lowest fits, because of the third spatial parameter q. This study also emphasises the importance of correctly choosing the best approach for determining the quality of model fits. The AIC and BIC have fundamentally different aims which suit different data sets and research questions. Regarding the question addressing whether habitat significantly effects model fits, it was found that there was a significant difference in model fits between different habitats but too many additional characteristics such as body size, taxa and feeding strategy were not considered in this study and ultimately would have impacted the ability to accurately detect a difference in preferred model for each habitat. These data were derived(\cite{Pawar2012}) paper on functional responses which emphasised the importance of dimensionality of the consumer search space, the model fits were also sub setted by consumer dimensionality. To address the question of dimensionality, this study found that dimensionality does impact the minimum AIC but there was no interaction between the model and the dimensionality, using the mechanistic model proposed by \cite{Pawar2012} would likely help produce more informative results of consumer-resource dynamics due to more accurate scaling relationships which is more appropriate for understanding population and food web dynamics. 
	
\newpage


\vspace*{1\baselineskip}
\printbibliography 


\newpage

\end{document}